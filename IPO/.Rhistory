setwd("E:/home/StockAnalysis/IPO/")
data = scan("benifit.txt")
data
hist(data)
fivenum(data)
median(data)
boxplot(data)
hist(data)
b = data
data = read.table("IPO detail.txt")
dim(data)
data[1:5]
data[1:5,]
data = read.table("IPO detail.txt", as.is=T)
data[1:5,]
colnames(data)
colnames(data) = c(ID, Name, IPOID, "Amount", "Online", "ApplyLimit", "Price", "PE", "industryPE", "ApplyDate", "TotalApplyCapital", "QutationRate", "SucessRate", "CaptialPerHand", "SucessNo", "ListDate", "BenifitPerHand", "ZTNum", "details", "BenefitRatio")
colnames(data) = c("ID", "Name", "IPOID", "Amount", "Online", "ApplyLimit", "Price", "PE", "industryPE", "ApplyDate", "TotalApplyCapital", "QutationRate", "SucessRate", "CaptialPerHand", "SucessNo", "ListDate", "BenifitPerHand", "ZTNum", "details", "BenefitRatio")
data[1:5,]
?lm
lm(Price~BenifitPerHand, data)
lm(Price~ZTnum, data)
lm(Price~ZTNum, data)
lm(Price~BenifitRatio, data)
colnames(data)
lm(Pricce~BenefitRatio, data)
lm(Price~BenefitRatio, data)
data= data[,-"BenefitRatio"]
data= data[,-c("BenefitRatio")]
colnames(data) = c("ID", "Name", "IPOID", "Amount", "Online", "ApplyLimit",
"Price", "PE", "industryPE", "ApplyDate", "TotalApplyCapital",
"QutationRate", "SucessRate", "CaptialPerHand", "SucessNo", "ListDate",
"BenifitPerHand", "ZTNum", "details", "BenifitRatio")
data = read.table("IPO detail.txt")
data[1:5,]
data= data[,-dim(data)[2]]
colnames(data) = c("ID", "Name", "IPOID", "Amount", "Online", "ApplyLimit",
"Price", "PE", "industryPE", "ApplyDate", "TotalApplyCapital",
"QutationRate", "SucessRate", "CaptialPerHand", "SucessNo", "ListDate",
"BenifitPerHand", "ZTNum", "details")
data[1:5,]
?attach
attach(data)
AmountPerHand <<- CaptialPerHand * SucessNo / Price
CaptialPerHand
AmountPerHand <<- CaptialPerHand * SucessRate / Price
AmountPerHand
?round
AmountPerHand <<- round(CaptialPerHand * SucessRate / Price) * 100
AmountPerHand
ReturnRatePerHand = BenifitPerHand / (Price * AmountPerHand) * 100
ReturnRatePerHand
ReturnRatePerHand <<- BenifitPerHand / (Price * AmountPerHand) * 100
ReturnRatePerCapital <<- BenifitPerHand / CaptialPerHand
ReturnRatePerCapital
ReturnRatePerCapital <<- BenifitPerHand / (CaptialPerHand * 10000) * 100
cov(data)
colnames(data)
detach(data)
dim(data)
attach(data)
data[,"AmountPerHand"] = round(CaptialPerHand * SucessRate / Price) * 100
colnames(data)
data[, "ReturnRatePerHand"] <<- BenifitPerHand / (Price * AmountPerHand) * 100
data[, "ReturnRatePerHand"] = BenifitPerHand / (Price * AmountPerHand) * 100
data[, "ReturnRatePerCapita"l <<- BenifitPerHand / (CaptialPerHand * 10000) * 100
data[, "ReturnRatePerCapita"]<<- BenifitPerHand / (CaptialPerHand * 10000) * 100
data[, "ReturnRatePerCapita"]= BenifitPerHand / (CaptialPerHand * 10000) * 100
colnames(data)
numCol = c(4:9, 12:14, 17, 18, 20:22)
cov(data[, numCol])
cor(data[, numCol])
heatmap(.Last.value)
numCol = c(4:9, 12:14, 17, 18, 20:22)
co = cor(data[, numCol])
fivenum(co)
hist(co)
?heatmap
heatmap(co)
diag(co) = 0
fivenum(abs(co))
co[abs(co) < 0.3] = 0
heatmap(co)
co['PE',]
co
heatmap(abs(co)
)
?image
image(co)
image(co, col=c("gree", "white", "red"), breaks=c(-1, -0.3, 0.3, 1))
image(co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1))
image(colnames(co), rownames(co),co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1))
image(1:ncol(co), 1:nrow(co), co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1))
image(1:ncol(co), 1:nrow(co), co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1), axis="N")
image(1:ncol(co), 1:nrow(co), co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1), axis="n")
image(1:ncol(co), 1:nrow(co), co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1),)
image(1:ncol(co), 1:nrow(co), co, col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1),
xat="", yat="")
warnings()
xaxt="", yaxt="")
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1),
xaxt="n", yaxt="n")
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1),
xaxt=colnames(co), yaxt="n", xlab="n", ylab="n")
?par
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1),
xaxt="n", yaxt="n", xlab="n", ylab="n")
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1),
xaxt="n", yaxt="n", xlab="", ylab="")
axis(side=1, at=1:ncol(co), names=colnames(data)[numCol])
axis(side=1, at=1:ncol(co), labels=colnames(data)[numCol])
colnames(data)[numCol]
warnings()
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "white", "red"), breaks=c(-1, -0.3, 0.3, 1))
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
colnames(data)[numCol]
co = cor(data[, numCol])
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
colnames(data)[numCol]
co[-1]
colnames(co)
co[14,]
co[1:3,1:3]
co[11:14,11:14]
sCol=c("Amout", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "BenifitPerHand", "ReturnRatePerHand", "ReturnRatePerCapita" )
numCol= sCol
co = cor(data[, numCol])
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
colnames(data)[numCol]
numCol
data[, numCol]
sCol %in% colnames(data)
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "BenifitPerHand", "ReturnRatePerHand", "ReturnRatePerCapita" )
numCol= sCol
co = cor(data[, numCol])
image(1:ncol(co), 1:nrow(co), co,
col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
numCol[7]
sCol[9:12]
co[9:11,9:11]
sCol[5:6]
image(1:ncol(co), 1:nrow(co), co, col=rainbow())
image(1:ncol(co), 1:nrow(co), co, col=rainbow(32))
image(1:ncol(co), 1:nrow(co), co, col=rainbow(8))
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "ReturnRatePerCapita" )
numCol= sCol
co = cor(data[, numCol])
image(1:ncol(co), 1:nrow(co), co, col=rainbow(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
?image
?image.plot
?image.default
libarary("fields")
library("fields")
install.packages("fields")
library("fields")
?image.plot
image(1:ncol(co), 1:nrow(co), co, col=rainbow(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
image.plot(1:ncol(co), 1:nrow(co), co, col=rainbow(8))
?image
image.plot(1:ncol(co), 1:nrow(co), co, col=heat.colors(8))
image.plot(1:ncol(co), 1:nrow(co), co, col=terrain.colors(8))
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
sCol[6:8]
co[6:8,6:8]
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "ReturnRatePerCapita" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
colnames(data)[numCol]
sCol
numCol
co
co[9:]
co[9,]
hsit(co)
hist(co)
diag[co] = 0.5
diag[co]
co
diag(co) = 0.5
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
hist(co)
diag(co) = na
diag(co) = NA
hist(co)
numCol = c(4:9, 12:14, 17, 18, 20:22)
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
numCol = c(4,9, 12:14, 17, 18, 20:22)
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
co[nrow(co),]
numCol = c(4,7:9, 12:14, 17, 18, 20:22)
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
colnames(data)[numCol]
co[nrow(co),]
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "ReturnRatePerCapita" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
colnames(data)[numCol]
co[nrow(co),]
co[nrow(co), order(abs(co[nrow(co)]))]
order(abs(co[nrow(co)]))
?order
order(abs(co[nrow(co),]))
co.rc = co["ReturnRatePerCapita",]
co.rc[order(abs(co.rc))]
co.rc[order(abs(co.rc), decreasing=T)]
hist(ReturnRatePerCapital)
data[, "ReturnRatePerCapital"]= BenifitPerHand / (CaptialPerHand * 10000) * 100
colnames(data)
numCol = c(4,7:9, 12:14, 17, 18, 20:22)
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "ReturnRatePerCapital" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
co.rc = co["ReturnRatePerCapita",]
co.rc = co["ReturnRatePerCapital",]
co.rc[order(abs(co.rc), decreasing=T)]
data[,"AmountPerHand"] = round(CaptialPerHand * SucessRate / Price) * 100
# RR, Return Rate
data[, "RRPerHand"] = BenifitPerHand / (Price * AmountPerHand) * 100
data[, "RRPerCapital"]= BenifitPerHand / (CaptialPerHand * 10000) * 100
colnames(data)
"CaptialPerHand", "RRPerCapital" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
co.rc = co["RRPerCapital",]
colnames(co)
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "RRPerCapital" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
colnames(co)
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
co.rc = co["RRPerCapital",]
co.rc[order(abs(co.rc), decreasing=T)]
hist(RRPerCapital)
hist(data$RRPerCapital)
dim(data)
quantile(data$RRPerCapital, 0.95)
attach(data)
hist(RRPerCapital)
quantile(RRPerCapital, 0.95)
dim(data)
data.sub = subset(data, RRPerCapital<6)
dim(data.sub)
hist(data.sub$RRPerCapital)
attach(data.sub)
colnames(data)
numCol = c(4,7:9, 12:14, 17, 18, 20:22)
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "RRPerCapital" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
co.rc = co["RRPerCapital",]
co.rc[order(abs(co.rc), decreasing=T)]
data.raw = data
data = data.sub
attach(data)
colnames(data)
numCol = c(4,7:9, 12:14, 17, 18, 20:22)
sCol=c("Amount", "Price", "AmountPerHand",
"PE", "industryPE", "QutationRate", "SucessRate",
"CaptialPerHand", "RRPerCapital" )
numCol= sCol
co = cor(data[, numCol])
image.plot(1:ncol(co), 1:nrow(co), co, col=topo.colors(8))
#col=c("green", "grey", "red"), breaks=c(-1, -0.3, 0.3, 1))
co.rc = co["RRPerCapital",]
co.rc[order(abs(co.rc), decreasing=T)]
hist(data.raw$RRPerCapital)
quantile(data.raw$RRPerCapital, c(0.05, 0.5, 0.95))
Amount
data[1,]
median(RRPerCapital)
dp = c(-0.2, 0.02, 0.051, 0.016, 0.011, 0.143)
am = c(700,800, 9000, 8663, 6500, 5000)
sum(dp*am)
savehistory()
exit()
q()
